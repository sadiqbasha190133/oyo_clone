
{% extends 'utils/base.html' %}

{% block start %}


<div class="container card shadow mt-5 p-5" style="width: 40%; border: none;">
    <form class="p-2" method="POST">
        {% csrf_token %}
        {% include 'utils/alerts.html' %}
        <h1 class="text-center">Login</h1>
        <div class="mb-3 {% if not show_email %} {{display}} {% endif %}" id="emailDiv">
            <label for="email" class="form-label">Email address</label>
            <input 
                type="email" 
                class="form-control" 
                id="email" 
                aria-describedby="emailHelp" 
                name="email"
                placeholder="Enter email here.."
                required
                value="{{email}}"
            >
            <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
            <button type="button" class="btn btn-success" id = "otpButton" onclick="onRequestOtp()"> Get OTP</button>
        </div>

        <div class="mb-3 {% if show_otp %} {{display_otp}} {% endif %}" id = "otpDiv">
            <label for="otp" class="form-label">OTP</label>
            <input 
                type="text" 
                class="form-control" 
                id="otp" 
                aria-describedby="otpHelp" 
                name="otp"
                placeholder="Enter OTP here.."
                required
            >
            <button type="button" class="btn btn-success mt-2" id = "otpButton" onclick="onVerifyOtp()"> Verify OTP</button>
        </div>
    </form>
</div>

<script>
    function onRequestOtp(){
        let email = document.getElementById('email').value
        console.log(email)
        return window.location.href = `/accounts/login-with-otp/${email}/`;
    }

    function onVerifyOtp(){
        let email = document.getElementById('email').value
        console.log(email)
        let otp = parseInt(document.getElementById("otp").value)
        console.log(otp)
        return window.location.href = `/accounts/${email}/verify-otp/${otp}/`;
    }

    
</script>


{% endblock %}